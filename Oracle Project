CREATE TABLE MOVIE (
MovieID CHAR(7) NOT NULL,
Title VARCHAR (105) NOT NULL,
Age VARCHAR (3) NOT NULL, ReleaseYear Number(4,0) NOT NULL, IMDb NUMBER (2,1) NOT NULL, RottenTomatoes NUMBER(3,2) NOT NULL, Runtime NUMBER (3,0) NOT NULL,
Netflix NUMBER (1,0) NOT NULL, HULU NUMBER (1,0) NOT NULL, Prime NUMBER(1,0) NOT NULL, DisneyPlus NUMBER (1,0) NOT NULL,
CONSTRAINT MOVIE_PK PRIMARY KEY (MovieID) );

CREATE TABLE DIRECTOR( DirectorID CHAR(7) NOT NULL, FirstName VARCHAR(15) NOT NULL, MiddleName VARCHAR (15), LastName VARCHAR (30),
Suffix VARCHAR (5),
CONSTRAINT DIRECTOR_PK PRIMARY KEY (DirectorID) );

CREATE TABLE MOVIEDIRECTOR( MovieID CHAR(7) NOT NULL, DirectorID CHAR(7) NOT NULL,
CONSTRAINT MOVIEDIRECTOR_PK PRIMARY KEY (MovieID, DirectorID) );

CREATE TABLE GENRE(
MovieID CHAR(7) NOT NULL,
Genre VARCHAR(15) NOT NULL,
CONSTRAINT GENRE_PK PRIMARY KEY (MovieID, Genre) );

CREATE TABLE LANGUAGE( MovieID CHAR(7) NOT NULL, Language VARCHAR(25) NOT NULL,
CONSTRAINT LANGUAGE_PK PRIMARY KEY (MovieID, Language) );

CREATE TABLE COUNTRY(
MovieID CHAR(7) NOT NULL,
COUNTRY VARCHAR(30) NOT NULL,
CONSTRAINT COUNTRY_PK PRIMARY KEY (MovieID, Country) );


--Question 1, Part 1 (Movies Netflix Should Carry)

SELECT Title
FROM MOVIE JOIN LANGUAGE ON MOVIE.MovieID = LANGUAGE.MovieID JOIN GENRE ON MOVIE.MovieID = GENRE.MovieID JOIN COUNTRY ON MOVIE.MovieID = COUNTRY.MovieID
WHERE IMDB > (SELECT AVG (IMDB) FROM MOVIE) AND RottenTomatoes > (SELECT AVG (RottenTomatoes) FROM MOVIE) AND (2020 - ReleaseYear > 1)
GROUP BY Title
ORDER BY Title ASC;

--Question 1, Part 2 (Movies Hulu Should Carry)

SELECT Title
FROM MOVIE JOIN LANGUAGE ON MOVIE.MovieID = LANGUAGE.MovieID JOIN GENRE ON MOVIE.MovieID = GENRE.MovieID JOIN COUNTRY ON MOVIE.MovieID = COUNTRY.MovieID
WHERE Language = 'English' AND Country = 'United States' AND IMDB > (SELECT AVG (IMDB) FROM MOVIE) AND RottenTomatoes > (SELECT AVG (RottenTomatoes) FROM MOVIE) AND (2020 - ReleaseYear > 1)
GROUP BY Title
ORDER BY Title ASC;

--Question 1, Part 3 (Movies Prime Video Should Carry)

SELECT Title
FROM MOVIE JOIN LANGUAGE ON MOVIE.MovieID = LANGUAGE.MovieID JOIN GENRE ON MOVIE.MovieID = GENRE.MovieID JOIN COUNTRY ON MOVIE.MovieID = COUNTRY.MovieID
WHERE Language = 'English' AND Country = 'United States' AND IMDB > (SELECT AVG (IMDB) FROM MOVIE) AND RottenTomatoes > (SELECT AVG (RottenTomatoes) FROM MOVIE)
GROUP BY Title
ORDER BY Title ASC;

--Question 1, Part 4 (Movies Disney Plus Should Carry)
    
SELECT Title
FROM MOVIE JOIN LANGUAGE ON MOVIE.MovieID = LANGUAGE.MovieID JOIN GENRE ON MOVIE.MovieID = GENRE.MovieID JOIN COUNTRY ON MOVIE.MovieID = COUNTRY.MovieID
WHERE Language = 'English' AND Country = 'United States' AND Genre IN ('Animation','Comedy') AND Age IN ('7+', '13+')
GROUP BY Title
ORDER BY Title ASC;
